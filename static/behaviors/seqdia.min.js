"use strict";var SequenceDiagram=function(){var t,e=function(){function t(t,e){this.textHeight=12,this.stripWidth=20,this.name=t,this.chart=e}return t.factory=function(e,i){var h=i.actorsByName[e];return h||i.actors.push(i.actorsByName[e]=h=new t(e,i)),h},t.prototype.getIndex=function(){return this.chart.actors.indexOf(this)},t.prototype.getWidth=function(){return(this.chart.width-this.chart.padding*(_.size(this.chart.actors)+1))/_.size(this.chart.actors)},t.prototype.getHeight=function(){return 40},t.prototype.getX=function(){return(this.getWidth()+this.chart.padding)*this.getIndex()+this.chart.padding},t.prototype.getY=function(){return this.chart.padding},t.prototype.render=function(){return[$.createSvgTag("rect",{"class":"strip",x:this.getX()+this.getWidth()/2-this.stripWidth/2,y:this.getY()+this.getHeight(),width:this.stripWidth,height:this.chart.height-this.getHeight()-this.getY()}),$.createSvgTag("rect",{x:this.getX(),y:this.getY(),width:this.getWidth(),height:this.getHeight()}),$.createSvgTag("text",{x:this.getX()+this.getWidth()/2,y:this.getY()+this.getHeight()/2+this.textHeight/2},this.name)]},t}();!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(t||(t={}));var i=function(){function e(t,e,i,h){this.arrowWidth=15,this.labelHeight=15,this.label=t,this.chart=h,this.actor1=e,this.actor2=i}return e.prototype.getIndex=function(){return this.chart.sequences.indexOf(this)},e.prototype.getWidth=function(){return Math.abs(this.actor1.getX()-this.actor2.getX())},e.prototype.getX=function(){return Math.min(this.actor1.getX(),this.actor2.getX())+this.actor1.getWidth()/2},e.prototype.getY=function(){return this.actor1.getY()+this.actor1.getHeight()+this.chart.padding+this.getHeight()*this.getIndex()},e.prototype.getHeight=function(){return 50},e.prototype.getDirection=function(){return this.actor1.getX()<this.actor2.getX()?t.Right:t.Left},e.prototype.getArrowX=function(){return this.getX()+(this.getDirection()==t.Left?0:this.getWidth())},e.prototype.getArrowAngle=function(){return this.getDirection()==t.Left?-45:135},e.prototype.render=function(){return[$.createSvgTag("text",{x:this.getX()+this.getWidth()/2,y:this.getY()+this.getHeight()/2-this.labelHeight/2},this.label),$.createSvgTag("line",{x1:this.getX()+(this.getDirection()==t.Left?this.arrowWidth/2:0),y1:this.getY()+this.getHeight()/2,x2:this.getX()+this.getWidth()-(this.getDirection()==t.Right?this.arrowWidth/2:0),y2:this.getY()+this.getHeight()/2}),$.createSvgTag("polygon",{points:"0,0 0,"+this.arrowWidth+" "+this.arrowWidth+",0",transform:"translate("+this.getArrowX()+", "+(this.getY()+this.getHeight()/2)+") rotate("+this.getArrowAngle()+")"})]},e}(),h=function(){function t(t,e,i){this.padding=20,this.actorsByName={},this.actors=[],this.sequences=[],this.width=t,this.height=e,this.svg=$.createSvgTag("svg",{viewBox:"0 0 "+t+" "+e,preserveAspectRatio:"xMidYmin meet"},"").appendTo(i)}return t.prototype.newSequence=function(t,h,r){this.sequences.push(new i(r,e.factory(t,this),e.factory(h,this),this))},t.prototype.render=function(){this.svg.innerHTML="";var t=this;_.each([this.actors,this.sequences],function(e){_.each(e,function(e){_.each(e.render(),function(e){t.svg.append(e)})})})},t}();return h}();